<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Wilder (MVP)</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="css/app.css" />
</head>

<body>
  <div class="app">
    <div class="topbar">
      <div class="brand">
        <strong>Wilder</strong>
        <span>Foraging MVP (Local Edition)</span>
      </div>
      <div class="pill" id="regionPill">Region: Loading…</div>
<button class="pill pillBtn" id="btnTheme" type="button">Bright</button>
<div class="pill" id="debugPill">Boot: …</div>
    </div>

    <div class="radar">
      <div class="mapWrap">
        <div id="map"></div>

        <div class="mapHUD">
          <div class="hudBox" id="hudLeft"><b>Radar</b><br><span id="hudMode">Loading data…</span></div>
          <div class="hudBox" id="hudRight"><b id="hudCount">0</b> cards<br><span id="hudMonth"></span></div>
        </div>

        <div class="reticle">
          <div class="reticlePulse"></div>
        </div>

    <div class="btnRow">
      <div class="btn" id="btnLocate">Locate</div>
      <div class="segToggle" id="vizToggle">
      <button class="segBtn active" data-mode="hotspots" type="button">Hotspots</button>
      <button class="segBtn" data-mode="points" type="button">All points</button>
      </div>
      <div class="btn" id="btnResort">Resort</div>
    
      <div class="btnRowSpacer"></div>
    
      <label class="topNControl" for="topN">
        Top
        <input id="topN" type="number" min="1" max="200" value="12" inputmode="numeric">
      </label>
    </div>

      </div><!-- CLOSE mapWrap -->

      <div class="deckWrap">
        <div class="deckHeader">
          <div class="title">
            <strong>The Deck</strong>
            <span>Sorted by nearby observations + seasonality (MVP)</span>
          </div>
          <div class="meta">
            <span class="mono" id="metaDate"></span>
          </div>
        </div>
        <div class="deck" id="deck"></div>
      </div>
    </div>
  </div>

  <!-- Specimen overlay -->
  <div class="overlay" id="overlay">
    <div class="sheet">
      <div class="sheetTop">
        <div class="sheetNames">
          <strong id="specSci"></strong>
          <span id="specCommon"></span>
        </div>
        <button class="sheetClose" id="btnClose">Close</button>
      </div>

      <div class="sheetBody">
        <div class="specVisual" id="specVisual"></div>

        <div class="grid" id="specGrid"></div>

        <div class="block" id="specIdBlock">
          <h3>Identification markers</h3>
          <p id="specId"></p>
        </div>

        <div class="block warning" id="specLookBlock" style="display:none;">
          <h3>Lookalike warning</h3>
          <p id="specLook"></p>
        </div>

        <button class="actionTab" id="btnCulinary">View culinary uses →</button>

        <div class="flipStage" id="flipStage">
          <div class="flip" id="flip">
            <div class="face front">
              <div class="block" style="margin-top:0;">
                <h3>Kitchen</h3>
                <p>Tap “Flip card” to see preparation + a simple recipe.</p>
              </div>
              <div class="flipBtns">
                <button class="smallBtn" id="btnFlip">Flip card</button>
                <button class="smallBtn" id="btnHideKitchen">Hide</button>
              </div>
            </div>

            <div class="face back">
              <p class="noteTitle">Recipe card (MVP)</p>
              <div class="note" id="recipeBody"></div>
              <div class="noteLine"></div>
              <div class="flipBtns">
                <button class="smallBtn" id="btnFlipBack">Flip back</button>
                <button class="smallBtn" id="btnHideKitchen2">Close</button>
              </div>
            </div>
          </div>
        </div>

        <div class="block danger" style="margin-top:12px;">
          <h3>Safety</h3>
          <p>Never eat anything you cannot identify with high confidence. This app is a starter pack, not a guarantee.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Risk modal -->
  <div class="modal" id="riskModal">
    <div class="modalCard">
      <h2>Foraging disclaimer</h2>
      <p>This MVP provides general guidance only. You forage at your own risk.</p>
      <ul>
        <li>Misidentification can cause serious harm.</li>
        <li>Check lookalikes and use multiple ID markers.</li>
        <li>Avoid polluted areas (roadsides, sprayed lawns).</li>
      </ul>
      <div class="modalRow">
        <div class="btn btnDanger" id="btnDecline">I do not agree</div>
        <div class="btn" id="btnAgree">I agree</div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script type="module" src="js/app.js"></script>
</body>
</html>
